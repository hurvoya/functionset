kpi6_global = (
    contracts_per_dealer_6m
    .groupby(["country", "year"], as_index=False)
    .agg(
        mean_contracts_6m=("nb_contracts_6m", "mean"),
        median_contracts_6m=("nb_contracts_6m", "median"),
        nb_new_dealers=("id_apporteur", "nunique")
    )
)

kpi6_global["mean_contracts_6m"] = kpi6_global["mean_contracts_6m"].round(2)
kpi6_global["median_contracts_6m"] = kpi6_global["median_contracts_6m"].round(2)
