ğŸ¯ 1) Objectif Purge Tiers (logique & rÃ¨gles)

Le niveau dâ€™analyse se fait au niveau SIREN (et non client_id), donc on devra :

(a) regrouper les clients par SIREN

(b) identifier lâ€™ensemble des contrats, demandes, contentieux associÃ©s Ã  un mÃªme SIREN

(c) Ã©valuer les rÃ¨gles pour dÃ©terminer lâ€™Ã©ligibilitÃ© Ã  la purge.

ğŸ”— Relations clÃ©s
Table	ClÃ© de jointure	Vers quoi ?
df_client	client_id	df_contract.contract_client_id & df_request.request_client_id
df_contract	contract_id	df_contentieux.cont_contract_id
âœ… RÃ¨gles de purge exprimÃ©es simplement

Pour un SIREN donnÃ© :

Tous les contrats doivent Ãªtre au statut TER
â†’ ET la date de fin du contrat doit Ãªtre > 6 ans dans le passÃ©

Aucune demande (df_request) ne doit avoir request_last_modification_date < 12 mois

Si au moins une demande est au statut ACC,
â†’ sa request_last_modification_date doit Ãªtre > 6 ans

Si au moins un contrat est en contentieux (contract_code_structure = 'X')
â†’ alors TOUS les contrats en contentieux doivent Ãªtre archivÃ©s contentieux (status 92,93,99 dans df_contentieux)
â†’ ET la date dâ€™archivage la plus rÃ©cente doit Ãªtre > 6 ans

ğŸ§± Ã‰tapes de construction (pragmatique)
1) PrÃ©parer la table Tiers / SIREN
-- Attention : certains client n'ont pas de SIREN â†’ Ã  analyser Ã  part
SIREN_BY_CLIENT = df_client

2) Contrats par SIREN

â†’ On joint df_client Ã  df_contract
â†’ On agrÃ¨ge : min(contract_end_date), count(*), % TER, % en contentieux

3) Demandes par SIREN

â†’ On joint df_client Ã  df_request
â†’ On calcule la derniÃ¨re date de modification + le nombre de demandes ACC

4) Contentieux

â†’ On garde pour chaque contrat la date max des statuts (92/93/99)

ğŸ“Š Volet Analyse des DonnÃ©es (ce que tu veux)
A) QualitÃ© & CohÃ©rence des identifiants
Analyse	Explication
Nombre de clients sans SIREN	â†’ Peut indiquer des fiches non consolidÃ©es / anonymes
Nombre de SIREN associÃ©s Ã  plusieurs client_id	â†’ Cas de doublons potentiels
Nombre de clients sans contrat	â†’ Tiers prospect abandonnÃ©s ?
Nombre de clients sans demande ni contrat	â†’ Tiers obsolÃ¨te ? Purge souvent immÃ©diate.
B) Couverture Contrats / Demandes
Analyse	Indicateur
% de contrats actifs vs terminÃ©s	QualitÃ© de maturitÃ© parc client
% de demandes ACC modifiÃ©es < 6 ans	Frein Ã  la purge
% de contrats passÃ©s en contentieux	Risque juridique
C) Historique & DurÃ©es
Analyse	Indicateur
AnciennetÃ© moyenne des contrats terminÃ©s	VÃ©rification cohÃ©rence rÃ¨gle 6 ans
DÃ©lai moyen entre demande â†’ contrat	Utilisation commerciale
ğŸ§© Indicateurs Concrets Ã  Calculer
Indicateur	Formule	UtilitÃ©
Nb clients sans SIREN	count(client_id) where client_siren is null	Voir si besoin nettoyage
Nb SIREN multi client_id	count(distinct client_id) per SIREN > 1	Identifier doublons potentiels
Nb tiers sans contrat	client_id not in df_contract	Tiers non exploitÃ©
Nb tiers sans demande	client_id not in df_request	VÃ©rifie inactivitÃ©
Nb tiers sans contrat & sans demande	cas purge rapide	Candidat purge direct
