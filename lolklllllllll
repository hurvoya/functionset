def compute_kpi_volume(df, ibl=None):
    data = df.copy()
    
    if ibl is not None:
        data = data[data["ibl"] == ibl]

    kpi = (
        data
        .groupby(["country", "is_key_account"])
        .agg(nb_dealers=("id_apporteur", "nunique"))
        .reset_index()
    )

    return kpi
