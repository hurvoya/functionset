%_Contracts_BPM :=
DIVIDE(
    -- Numérateur : Nb contrats MEL où FLG_BPM = 1
    CALCULATE(
        DISTINCTCOUNT(MEL[Contract Id]),
        MEL[FLG_BPM] = 1,
        MEL[Flag_Country] = 1,
        TREATAS(VALUES(Fait_All[Country]), MEL[Country]),
        TREATAS(VALUES(Fait_All[IBL]), MEL[IBL])
    ),
    -- Dénominateur : Nb total de contrats MEL
    CALCULATE(
        DISTINCTCOUNT(MEL[Contract Id]),
        MEL[Flag_Country] = 1,
        TREATAS(VALUES(Fait_All[Country]), MEL[Country]),
        TREATAS(VALUES(Fait_All[IBL]), MEL[IBL])
    )
)
