Avg_Lead_Time_Days :=
CALCULATE(
    AVERAGE(Spotfire[Lead Time in Days]),
    Spotfire[Flag_Country] = 1,
    Spotfire[FLG_MEL_Valide] = 1,
    TREATAS(VALUES(Fait_All[Country]), Spotfire[Country]),
    TREATAS(VALUES(Fait_All[IBL]), Spotfire[IBL]),
    TREATAS(VALUES(Fait_All[Organisme]), Spotfire[Organisme]),
    TREATAS(VALUES(Fait_All[Partner]), Spotfire[Partner]),
    TREATAS(VALUES(Fait_All[Financial Product]), Spotfire[Financial Product]),
    TREATAS(VALUES(Fait_All[Commercial Product]), Spotfire[Commercial Product]),
    TREATAS(VALUES(Fait_All[Market]), Spotfire[Market]),
    TREATAS(VALUES(Fait_All[Apporteur]), Spotfire[Apporteur]),
    TREATAS(VALUES(Fait_All[Agence]), Spotfire[Agence])
)


Avg_Last_Doc_LeadTime :=
CALCULATE(
    AVERAGE(Spotfire[Last Doc LeadTime in Days]),
    Spotfire[Flag_Country] = 1,
    Spotfire[FLG_MEL_Valide] = 1,
    TREATAS(VALUES(Fait_All[Country]), Spotfire[Country]),
    TREATAS(VALUES(Fait_All[IBL]), Spotfire[IBL]),
    TREATAS(VALUES(Fait_All[Organisme]), Spotfire[Organisme]),
    TREATAS(VALUES(Fait_All[Partner]), Spotfire[Partner]),
    TREATAS(VALUES(Fait_All[Financial Product]), Spotfire[Financial Product]),
    TREATAS(VALUES(Fait_All[Commercial Product]), Spotfire[Commercial Product]),
    TREATAS(VALUES(Fait_All[Market]), Spotfire[Market]),
    TREATAS(VALUES(Fait_All[Apporteur]), Spotfire[Apporteur]),
    TREATAS(VALUES(Fait_All[Agence]), Spotfire[Agence])
)
