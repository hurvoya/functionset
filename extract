# On part de DF avec les colonnes : LAND1 et STCD2

# Dictionnaire pays -> sous-dataframe
pays_map = {
    "FR": "df_france",
    "IT": "df_italie",
    "DE": "df_allemagne",
    "BE": "df_belgique",
    "NL": "df_netherland",
    "ES": "df_espagne",
}

# Dictionnaire où on stockera les DFS
dfs = {}

for code_pays, nom_df in pays_map.items():
    sub = (
        DF.loc[DF["LAND1"] == code_pays, ["STCD2"]]   # filtre par pays + garde STCD2
        .dropna(subset=["STCD2"])                     # enlève les lignes vides
        .drop_duplicates()                            # enlève les doublons
        .rename(columns={"STCD2": "siren"})           # renomme la colonne
        .reset_index(drop=True)                       # reset propre
    )
    dfs[nom_df] = sub

# Tu peux ensuite accéder ainsi :
df_france     = dfs["df_france"]
df_italie     = dfs["df_italie"]
df_allemagne  = dfs["df_allemagne"]
df_belgique   = dfs["df_belgique"]
df_netherland = dfs["df_netherland"]
df_espagne    = dfs["df_espagne"]
