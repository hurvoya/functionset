DF["contract_end_date_x"] = pd.to_datetime(DF["contract_end_date_x"], errors="coerce")
DF["contract_end_date_y"] = pd.to_datetime(DF["contract_end_date_y"], errors="coerce")


DF["flg_end_date_equal"] = (
    (DF["contract_end_date_x"] == DF["contract_end_date_y"]) |
    (DF["contract_end_date_x"].isna() & DF["contract_end_date_y"].isna())
).astype(int)

DF["flg_end_date_equal"].value_counts()

