# combien d'apporteurs ont >1 event la même année ?
multi_same_year = (
    events.assign(year=pd.to_datetime(events["date_new_dealer"]).dt.year)
          .query("year in [2024, 2025]")
          .groupby(["country", "year", "id_apporteur"])["event_id"].nunique()
          .reset_index(name="n_events")
          .query("n_events > 1")
)

multi_same_year.shape[0], multi_same_year.head()
