dealer_dim = (
    df[["country", "id_apporteur", "dte_creation_v2"]]
    .drop_duplicates(subset=["country", "id_apporteur"])
    .rename(columns={"dte_creation_v2": "date_creation_apporteur"})
)

dealer_dim["date_creation_apporteur"] = pd.to_datetime(
    dealer_dim["date_creation_apporteur"], errors="coerce"
).dt.normalize()


events = events.merge(
    dealer_dim,
    on=["country", "id_apporteur"],
    how="left"
)


events["date_creation_apporteur"].isna().mean()
