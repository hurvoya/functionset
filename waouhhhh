scatter_df = (
    stock
    .query("is_key_account == False")
    .assign(
        year=lambda x: x["date_new_dealer"].dt.year
    )
    .query("year in [2024, 2025]")
    .groupby(["country", "id_apporteur", "event_id", "year"])
    .agg(
        nb_calls_total=("nb_calls_mois", "sum"),
        montant_finance_total=("montant_finance_mois", "sum"),
        new_dealer_type=("new_dealer_type", "first"),
    )
    .reset_index()
)
