dfc["rolling_max_fin_prev"] = (
    dfc.groupby([country_col, dealer_col])[fin_col]
       .transform(lambda s: s.cummax().shift(1))
)
