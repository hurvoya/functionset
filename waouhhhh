1ï¸âƒ£ Sanity check global
ğŸ”¹ VolumÃ©trie de base
stock.shape
events.shape


Ã€ vÃ©rifier :

events a moins de lignes que de dealers

stock a â‰ˆ 6 Ã— nb_events (moins si cap 8 atteint tÃ´t)

ğŸ”¹ UnicitÃ© des lignes stock
stock.duplicated(
    ["country", "id_apporteur", "event_id", "mois_ref"]
).sum()


ğŸ‘‰ Doit Ãªtre 0
Sinon â†’ souci de jointure.

2ï¸âƒ£ VÃ©rification des Ã©vÃ©nements New Dealer
ğŸ”¹ Un dealer peut avoir plusieurs events
events.groupby(["country", "id_apporteur"]).size().describe()


Ã€ vÃ©rifier :

majoritÃ© Ã  1

quelques >1 (rÃ©activations) â†’ normal

ğŸ”¹ RÃ©partition First Time / Known
events["new_dealer_type"].value_counts(normalize=True)


ğŸ‘‰ Les proportions doivent Ãªtre cohÃ©rentes mÃ©tier (pas 99 % / 1 % par surprise).

3ï¸âƒ£ VÃ©rification du suivi 6 mois / 8 contrats
ğŸ”¹ Cap Ã  8 contrats respectÃ©
stock["nb_contrats_cum"].max()


ğŸ‘‰ Doit Ãªtre â‰¤ 8

ğŸ”¹ Sortie du suivi quand cap atteint
stock.query("nb_contrats_cum >= 8")[["en_suivi", "sorti_du_suivi"]].drop_duplicates()


ğŸ‘‰ en_suivi = False, sorti_du_suivi = True

ğŸ”¹ Pas plus de 6 mois par event
stock.groupby(["country", "id_apporteur", "event_id"])["mois_ref"].nunique().describe()


ğŸ‘‰ Max = 6

4ï¸âƒ£ VÃ©rification CALLS = contrats suivis
ğŸ”¹ Calls = contrats par mois
(stock["nb_calls_mois"] == stock["nb_contrats_mois"]).all()


ğŸ‘‰ Doit Ãªtre True

ğŸ”¹ Calls cumulÃ©s cohÃ©rents
(stock["nb_calls_cum"] == stock["nb_contrats_cum"]).all()


ğŸ‘‰ Doit Ãªtre True

5ï¸âƒ£ VÃ©rification des montants financÃ©s (le point clÃ© pour toi)
ğŸ”¹ Cumul bien progressif

Prends 1 dealer au hasard :

one = (
    stock
    .query("id_apporteur == @SOME_ID")
    .sort_values(["event_id", "mois_ref"])
)

one[[
    "date_new_dealer",
    "mois_ref",
    "nb_contrats_mois",
    "nb_contrats_cum",
    "montant_finance_mois",
    "montant_finance_cum"
]]


Ã€ vÃ©rifier visuellement :

montant_finance_cum = somme des montant_finance_mois jusquâ€™au mois courant

progression logique (pas de reset, pas de saut)

ğŸ”¹ Montant nul quand pas de contrat
stock.query("nb_contrats_mois == 0")["montant_finance_mois"].describe()


ğŸ‘‰ Doit Ãªtre 0 partout

6ï¸âƒ£ Key Account (filtre prÃªt pour lâ€™analyse)
ğŸ”¹ Flag bien posÃ©
stock["is_key_account"].value_counts()

ğŸ”¹ VÃ©rification du filtre futur
stock_no_ka = stock[stock["is_key_account"] == False]


ğŸ‘‰ Toutes les analyses 2 â†’ N devront partir de stock_no_ka.

7ï¸âƒ£ VÃ©rification multi-pays (important pour la suite)
ğŸ”¹ Chaque pays indÃ©pendant
stock.groupby("country")["id_apporteur"].nunique()


ğŸ‘‰ Pas de mÃ©lange entre pays.
