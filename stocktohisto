Un contrat est en vie pour un mois de stock M si et seulement si :

date_debut < 1er jour du mois M

date_fin â‰¥ 1er jour du mois M + 1 mois

ðŸ’¡ filtre date :

Il faut que le contrat ait commencÃ© avant le mois, pas pendant.

Et quâ€™il soit encore actif aprÃ¨s la fin du mois, donc fin â‰¥ 1er du mois suivant.

On exclut les NaT en date_fin (ils ne sont pas traitÃ©s).



Points clÃ©s :
Une ligne par client et par mois, peu importe combien de contrats un client a pour ce mois-lÃ .

DonnÃ©es les plus rÃ©centes par rapport Ã  date_mel pour chaque client.

Tu peux ajouter autant de variables que tu veux dans le DataFrame, elles seront considÃ©rÃ©es lors du tri (par exemple Partenaire, IBL, etc.).
