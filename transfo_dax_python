1. Jointure (Left Join) entre df et X_Partner
df = df.merge(X_Partner[['CountryId', 'CompanyId', 'BrandingId', 'S_Partner']], 
              on=['CountryId', 'CompanyId', 'BrandingId'], 
              how='left')


2. Création de la colonne PartnerGRP
df['PartnerGRP'] = df.apply(
    lambda row: row['CompanyId'] if pd.isna(row['S_Partner']) else row['S_Partner'], axis=1
)



3. Suppression de la colonne S_Partner
df.drop(columns=['S_Partner'], inplace=True)



5. Création colonne Payout : 1 si RequestId_Payout non nul
df['Payout'] = df['RequestId'].isin(Payout_Case['RequestId']).astype(int)



Dernière étape : remplacer les NaN par 0 dans certaines colonnes
df['SoEasy'] = df['SoEasy'].fillna(0)
df['SDS'] = df['SDS'].fillna(0)


df['Payout'] = df[['CountryId', 'RequestId']].apply(tuple, axis=1).isin(
    Payout_Case[['CountryId', 'RequestId']].apply(tuple, axis=1)
).astype(int)
