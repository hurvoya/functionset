import pandas as pd

# Chargement des données (à remplacer par le bon fichier si besoin)
df = pd.read_csv("ton_fichier.csv")

# Étape 1 : Création de la colonne "RequestId"
df["RequestId"] = df.apply(
    lambda row: row["N° de la demande"] if pd.isna(row["N° du Contrat"]) else row["N° du Contrat"],
    axis=1
)

# Étape 2 : Garder uniquement les colonnes Pays et RequestId
df_selected = df[["Pays", "RequestId"]].copy()

# Étape 3 : Supprimer les doublons
df_selected.drop_duplicates(inplace=True)

# Étape 4 : Remplacer les codes pays longs par des codes à 2 lettres
replace_dict = {
    "ESP": "ES",
    "BEL": "BE",
    "FRA": "FR",
    "NLD": "NL",
    "DEU": "DE",
    "GBR": "UK"
}
df_selected["Pays"] = df_selected["Pays"].replace(replace_dict)

# Résultat final
Payout_Case = df_selected

# Exemple d'affichage
print(Payout_Case.head())
