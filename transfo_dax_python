def determine_esignature_type(row):
    if row['SDS'] == 0:
        return "Manual E-signature"
    elif row['esignature_substitution'] == 1:
        return "Internal E-signature"
    elif row['SDS'] == 1:
        return "Dealer E-signature"
    else:
        return None

df['esignature_type'] = df.apply(determine_esignature_type, axis=1)
