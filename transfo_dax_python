1. Trouver les groupes dupliqu√©s
# Groupe sur les colonnes suppos√©es uniques
group_cols = ['RequestId', 'CountryId']

# Filtrer les lignes dupliqu√©es sur ce groupe
dups = df[df.duplicated(subset=group_cols, keep=False)].copy()



2. Voir les variations ligne par ligne dans les doublons
# Regrouper par le duo et afficher les diff√©rences
diffs = dups.groupby(group_cols).nunique(dropna=False)

# Garder uniquement les colonnes o√π il y a plus d'une valeur (donc variation)
columns_with_variation = diffs.loc[:, diffs.gt(1).any()].columns.tolist()
print("üîç Colonnes qui varient dans les doublons :", columns_with_variation)



3. Afficher quelques exemples des doublons avec ces colonnes
# Affichage d'exemples de lignes probl√©matiques
example_dups = dups[group_cols + columns_with_variation].sort_values(group_cols)
print(example_dups.head(10))
